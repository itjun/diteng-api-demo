# diteng-demo-api

## 接入说明

1. 地藤配套的框架和工具类均基于 Oracle Java11 打包和发行。
2. 接入方需要必须先注册地藤帐套，由帐套管理员设置远程服务需要的 token，才能配套使用当前demo的示例

## 调用说明

### 创建销售订单

#### 一、功能描述

- 客户系统向地藤下发销售订单
- 销售订单后创建成功生成唯一销售订单号（幂等）
- 创建销售订单必须传递指定的客户代码，具体请联系地藤帐套持有者公司获取

#### 二、接口定义

2.1. 接口基本信息

| 名称     | 值                                   |
| :------- | ------------------------------------ |
| 服务名称 | tranod.append                        |
| 批量创建 | 不支持，建议一个订单发起一次创建请求 |
| 请求方式 | POST                                 |
| 报文类型 | JSON                                 |

2.2. 元素<请求> head

| 序   | 属性名    | 类型(约束) | 必填 | 默认值 | 描述                                      |
| ---- | --------- | ---------- | ---- | ------ | ----------------------------------------- |
| 1    | CusCode_  | String(10) | Yes  |        | 客户代码                                  |
| 2    | TBDate_   | String(20) | Yes  |        | 订单创建日期，格式 2021-10-24             |
| 3    | ManageNo_ | String(30) | Yes  |        | 第三方系统订单号（幂等），153491985015702 |

2.2. 元素<请求> body

| 序   | 属性名    | 类型(约束)   | 必填 | 默认值 | 描述                                            |
| ---- | --------- | ------------ | ---- | ------ | ----------------------------------------------- |
| 1    | PartCode_ | String(18)   | Yes  |        | 商品编号                                        |
| 2    | Desc_     | String(100)  |      |        | 商品名称                                        |
| 3    | Spec_     | String(100)  |      |        | 商品规格                                        |
| 4    | Num_      | Double(18,4) | Yes  |        | 商品数量                                        |
| 5    | SpareNum_ | Double(18,4) | Yes  | 0      | 赠品数量，如果当前记录是正品，商品数量=赠品数量 |
| 6    | OriUP_    | Double(18,4) | Yes  |        | 实际售价                                        |

2.3 元素<响应> DataSet

| 序   | 属性名  | 类型(约束)  | 必填 | 描述                     |
| ---- | ------- | ----------- | ---- | ------------------------ |
| 1    | state   | Integer     |      | 大于1表示调用成功        |
| 2    | message | String(100) | Yes  | 服务返回的消息           |
| 3    | head    | DataRow     |      | 业务数据，以实际返回为准 |

2.4 应用场景JSON示例

请求报文

```json
{
    "head": {
        "CusCode_": "C00397",
        "ManageNo_": "23422342342",
        "TBDate_": "2021/12/07"
    },
    "body": [
        [
            "PartCode_",
            "Desc_",
            "Spec_",
            "Num_",
            "SpareNum_",
            "OriUP_"
        ],
        [
            "0212DYRDR40350",
            "",
            "",
            5,
            0,
            3
        ],
        [
            "0212DYRDR40350",
            "",
            "",
            3,
            3,
            3
        ],
        [
            "11L20DLX-1",
            "",
            "",
            13,
            0,
            1.5
        ]
    ]
}
```

订单创建成功

```json
{
    "state": 1,
    "message": "销售订单创建成功",
    "head": {
        "TBNo_": "ODA211209008"
    }
}
```

订单创建失败

```json
{
    "message": "客户订单号不允许为空！"
}
```

```json
{
    "message": "客户订单号 23422342342 已导入，地藤单号：ODA211209005，不允许重复导入！"
}
```

```json
{
    "message": "商品编号 021YRDR40350 在地藤中不存在！"
}
```

```json
{
    "message": "商品编号 021YRDR40350 在地藤中已被停用！"
}
```

